<div class="container">
  <button class="back-button" (click)="goBack()">â† Back to Reviews</button>

  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading review details...</p>
  </div>

  <div class="error" *ngIf="error">
    <p>âŒ {{ error }}</p>
    <button (click)="goBack()">Go Back</button>
  </div>

  <div class="review-detail" *ngIf="review && !loading && !error">
    <header class="review-header">
        <div class="header-content">
            <h1>{{ review.repositoryName }}</h1>
            <p class="commit-message">{{ review.commitMessage }}</p>
        </div>
        <div [ngClass]="reviewStatusClass">
            {{ review.status }}
        </div>
    </header>

    <div class="review-meta">
      <div class="meta-card">
        <span class="meta-icon">ğŸ”–</span>
        <div class="meta-content">
          <span class="meta-label">Commit SHA</span>
          <code>{{ review.commitSha.substring(0, 12) }}...</code>
        </div>
      </div>

      <div class="meta-card">
        <span class="meta-icon">ğŸ‘¤</span>
        <div class="meta-content">
          <span class="meta-label">Author</span>
          <span class="meta-value">{{ review.author }}</span>
        </div>
      </div>

      <div class="meta-card">
        <span class="meta-icon">ğŸ“…</span>
        <div class="meta-content">
          <span class="meta-label">Committed</span>
          <span class="meta-value">{{ review.commitTimestamp | date:'short' }}</span>
        </div>
      </div>

      <div class="meta-card">
        <span class="meta-icon">ğŸ¤–</span>
        <div class="meta-content">
          <span class="meta-label">Reviewed</span>
          <span class="meta-value">{{ review.reviewTimestamp | date:'short' }}</span>
        </div>
      </div>
    </div>

    <div class="findings-section" *ngIf="review.findings.length > 0">
      <h2>ğŸ” Findings ({{ review.findings.length }})</h2>
      
      <!-- âœ… Use Findings Card Component -->
      <app-findings-card 
        *ngFor="let finding of review.findings" 
        [finding]="finding">
      </app-findings-card>
    </div>

    <div class="no-findings" *ngIf="review.findings.length === 0 && review.status === 'COMPLETED'">
      <div class="success-icon">âœ…</div>
      <h2>No Issues Found!</h2>
      <p>This code review didn't identify any issues. Great work!</p>
    </div>

    <div class="error-state" *ngIf="review.status === 'FAILED'">
      <div class="error-icon">âŒ</div>
      <h2>Review Failed</h2>
      <p class="error-message">{{ review.errorMessage }}</p>
    </div>
  </div>
</div>